
@article{qu_ptflash_2023,
	title = {{PTFlash} : {A} vectorized and parallel deep learning framework for two-phase flash calculation},
	volume = {331},
	issn = {0016-2361},
	shorttitle = {{PTFlash}},
	url = {https://www.sciencedirect.com/science/article/pii/S0016236122024334},
	doi = {10.1016/j.fuel.2022.125603},
	abstract = {Phase equilibrium calculations are an essential part of numerical simulations of multi-component multi-phase flow in porous media, accounting for the largest share of the computational time. In this work, we introduce a fast and parallel framework, PTFlash, that vectorizes algorithms required for two-phase flash calculation using PyTorch, and can facilitate a wide range of downstream applications. Vectorization promotes parallelism and consequently leads to attractive hardware-agnostic acceleration. In addition, to further accelerate PTFlash, we design two task-specific neural networks, one for predicting the stability of given mixtures and the other for providing estimates of the distribution coefficients, which are trained offline and help shorten computation time by sidestepping stability analysis and reducing the number of iterations to reach convergence. The evaluation of PTFlash was conducted on three case studies involving hydrocarbons, CO2 and N2, for which the phase equilibrium was tested over a large range of temperature, pressure and composition conditions, using the Soave–Redlich–Kwong (SRK) equation of state. We compare PTFlash with an in-house thermodynamic library, Carnot, written in C++ and performing flash calculations one by one on CPU. Results show speed-ups of up to two order of magnitude on large scale calculations, while maintaining perfect precision with the reference solution provided by Carnot.},
	urldate = {2025-04-20},
	journal = {Fuel},
	author = {Qu, Jingang and Faney, Thibault and de Hemptinne, Jean-Charles and Yousef, Soleiman and Gallinari, Patrick},
	month = jan,
	year = {2023},
	keywords = {Deep learning, Flash calculation, Two-phase equilibrium, Vectorization},
	pages = {125603},
	file = {Accepted Version:C\:\\Users\\Tibo\\Zotero\\storage\\R5YCMYZ3\\Qu et al. - 2023 - PTFlash  A vectorized and parallel deep learning framework for two-phase flash calculation.pdf:application/pdf},
}

@misc{qu_hmoe_2023,
	title = {{HMOE}: {Hypernetwork}-based {Mixture} of {Experts} for {Domain} {Generalization}},
	shorttitle = {{HMOE}},
	url = {http://arxiv.org/abs/2211.08253},
	doi = {10.48550/arXiv.2211.08253},
	abstract = {Due to domain shifts, machine learning systems typically struggle to generalize well to new domains that differ from those of training data, which is what domain generalization (DG) aims to address. Although a variety of DG methods have been proposed, most of them fall short in interpretability and require domain labels, which are not available in many real-world scenarios. This paper presents a novel DG method, called HMOE: Hypernetwork-based Mixture of Experts (MoE), which does not rely on domain labels and is more interpretable. MoE proves effective in identifying heterogeneous patterns in data. For the DG problem, heterogeneity arises exactly from domain shifts. HMOE employs hypernetworks taking vectors as input to generate the weights of experts, which promotes knowledge sharing among experts and enables the exploration of their similarities in a low-dimensional vector space. We benchmark HMOE against other DG methods under a fair evaluation framework -- DomainBed. Our extensive experiments show that HMOE can effectively separate mixed-domain data into distinct clusters that are surprisingly more consistent with human intuition than original domain labels. Using self-learned domain information, HMOE achieves state-of-the-art results on most datasets and significantly surpasses other DG methods in average accuracy across all datasets.},
	urldate = {2025-04-20},
	publisher = {arXiv},
	author = {Qu, Jingang and Faney, Thibault and Wang, Ze and Gallinari, Patrick and Yousef, Soleiman and Hemptinne, Jean-Charles de},
	month = nov,
	year = {2023},
	note = {arXiv:2211.08253 [cs]},
	keywords = {Computer Science - Artificial Intelligence, Computer Science - Computer Vision and Pattern Recognition, Computer Science - Machine Learning},
	file = {Preprint PDF:C\:\\Users\\Tibo\\Zotero\\storage\\HS8NBLJF\\Qu et al. - 2023 - HMOE Hypernetwork-based Mixture of Experts for Domain Generalization.pdf:application/pdf;Snapshot:C\:\\Users\\Tibo\\Zotero\\storage\\BJHR2WHP\\2211.html:text/html},
}

@article{nastorg_implicit_2024,
	title = {An implicit {GNN} solver for {Poisson}-like problems},
	volume = {176},
	issn = {0898-1221},
	url = {https://www.sciencedirect.com/science/article/pii/S0898122124004851},
	doi = {10.1016/j.camwa.2024.10.036},
	abstract = {This paper presents Ψ-GNN, a novel Graph Neural Network (GNN) approach for solving the ubiquitous Poisson PDE problems on general unstructured meshes with mixed boundary conditions. By leveraging the Implicit Layer Theory, Ψ-GNN models an “infinitely” deep network, thus avoiding the empirical tuning of the number of required Message Passing layers to attain the solution. Its original architecture explicitly takes into account the boundary conditions, a critical pre-requisite for physical applications, and is able to adapt to any initially provided solution. Ψ-GNN is trained using a physics-informed loss, and the training process is stable by design. Furthermore, the consistency of the approach is theoretically proven, and its flexibility and generalization efficiency are experimentally demonstrated: the same learned model can accurately handle unstructured meshes of various sizes, as well as different boundary conditions. To the best of our knowledge, Ψ-GNN is the first physics-informed GNN-based method that can handle various unstructured domains, boundary conditions and initial solutions while also providing convergence guarantees.},
	urldate = {2025-04-20},
	journal = {Computers \& Mathematics with Applications},
	author = {Nastorg, Matthieu and Bucci, Michele-Alessandro and Faney, Thibault and Gratien, Jean-Marc and Charpiat, Guillaume and Schoenauer, Marc},
	month = dec,
	year = {2024},
	pages = {270--288},
	file = {ScienceDirect Snapshot:C\:\\Users\\Tibo\\Zotero\\storage\\PSJEFWDJ\\S0898122124004851.html:text/html;Submitted Version:C\:\\Users\\Tibo\\Zotero\\storage\\UX86WSAJ\\Nastorg et al. - 2024 - An implicit GNN solver for Poisson-like problems.pdf:application/pdf},
}

@article{lechevallier_hybrid_2025,
	title = {Hybrid {Newton} method for the acceleration of well event handling in the simulation of {CO2} storage using supervised learning},
	volume = {197},
	issn = {0098-3004},
	url = {https://www.sciencedirect.com/science/article/pii/S0098300425000226},
	doi = {10.1016/j.cageo.2025.105872},
	abstract = {Geological storage of CO2 is an essential instrument for efficient Carbon Capture and Storage policies. Numerical simulations provide the solution to the multi-phase flow equations that model the behavior of the CO2 injection site. However, numerical simulations of fluid flow in porous media are computationally demanding: it can take up to several hours on a HPC cluster in order to simulate one injection scenario for a large CO2 reservoir if we want to accurately model the complex physical processes involved. This becomes a limiting issue when performing a large number of simulations, e.g. in the process of ‘history matching’. Well events, such as opening and closure, cause important numerical difficulties due to their instant impact on the pressure and saturation unknowns. This often forces a drastic reduction of the time step size to be able to solve the non-linear system of equations resulting from the discretization of the continuous mathematical model. However, these specific well events in a simulation have a relatively similar impact across space and time. We propose a proof of concept methodology to alleviate the impact of well events during the numerical simulation of CO2 storage in the underground by using a machine-learning based non-linear preconditioning. We complement the standard fully implicit solver by predicting an initialization of Newton’s method directly in the domain of quadratic convergence using supervised learning. More specifically, we replace the initialization in pressure by a linear approximation obtained through an implicit solver and we use a Fourier Neural Operator (FNO) to predict the saturation initialization. Furthermore, we present an open-source Python framework for conducting reservoir simulations and integrating machine-learning models. We apply our methodology to two test cases derived from a realistic CO2 storage in saline aquifer benchmark. We reduce the required number of Newton iterations to handle a well opening by 53\% for the first test case, i.e required number of linear system to solve and by 38\% for the second test case.},
	urldate = {2025-04-20},
	journal = {Computers \& Geosciences},
	author = {Lechevallier, Antoine and Desroziers, Sylvain and Faney, Thibault and Flauraud, Eric and Nataf, Frédéric},
	month = mar,
	year = {2025},
	keywords = {CO storage, Fourier Neural Operator, Machine learning, Newton method, Non-linear preconditioning, Reservoir simulation},
	pages = {105872},
	file = {ScienceDirect Snapshot:C\:\\Users\\Tibo\\Zotero\\storage\\A9BCKHI2\\S0098300425000226.html:text/html;Submitted Version:C\:\\Users\\Tibo\\Zotero\\storage\\2CT4I9FV\\Lechevallier et al. - 2025 - Hybrid Newton method for the acceleration of well event handling in the simulation of CO2 storage us.pdf:application/pdf},
}

@article{collard_machine_2023,
	title = {Machine learning model predicting hydrothermal dolomitisation for future coupling of basin modelling and geochemical simulations},
	volume = {637},
	issn = {0009-2541},
	url = {https://www.sciencedirect.com/science/article/pii/S0009254123003765},
	doi = {10.1016/j.chemgeo.2023.121676},
	abstract = {In the energy transition context, basin modelling, initially dedicated to the understanding of oil and gas systems, can address several challenges that the sustainable energy sector faces, such as identifying large storage volumes for carbon sequestration, determining the thermal recharge sources for geothermal exploration, or characterising the generation, migration, sink, and accumulation of critical element resources. In this regard, there is a need for spatiotemporal information on the mineral reactions that control the petrophysical properties of the rocks in order to map the best locations in the basin for capturing geothermal energy or storing carbon in basin-wide reservoirs for CO2 mitigation. Hydrothermal dolomitisation is one of these well-known diagenetic reactions that can enhance or destroy reservoir porosity. It has been extensively characterised by static reactive transport modelling, but not kinematic ones, due to the high computational cost of such reactive transport simulations. To address this issue, we built a machine-learning-based (ML) surrogate geochemical model for hydrothermal dolomitisation valid over a broad range of physical and chemical conditions encountered in such a context with the end goal of developing a generic exploration tool to be deployed in the basin calculator ArcTem for emerging energy needs. We train and test five regression algorithms (Random Forest, Gradient Boosting, AdaBoost, Support-Vector Machine, and Multilayer Perceptron) upon a synthetic dataset to predict the dissolved/precipitated amount of calcite and dolomite (referred to as δCaCO3 and δCaMg(CO3)2, respectively). The dataset contains 370 × 103 samples and six features (T, pH, NaCl, Ca, Mg, C) generated by a Latin Hypercube Sampling (LHS) between two end-members: (1) the modern seawater composition and a temperature of 80 °C for the lower bound and (2) a highly saline mantle-derived fluid and a temperature of 250 °C for the upper bound. The target values, i.e. dissolved/precipitated mole number of calcite/dolomite, are obtained by performing thermodynamic equilibrium calculations with the LHS samples as the initial unequilibrated solutions. Our results show that the artificial neural network (ANN) model best performs among the algorithms with rmse of 0.007 mol on δCaMg(CO3)2 prediction and 0.0084 mol on δCaCO3 prediction, R2 values above 0.99, and APE smaller than 0.3\%, indicating its good generalisability to provide accurate predictions on unseen data in the studied range. Further, the ANN model is ∼1000 times faster than the geochemical calculator when solving the same system at once, illustrating the great potential of ML methods in emulating computationally intensive components of the numerical simulations.},
	urldate = {2025-04-20},
	journal = {Chemical Geology},
	author = {Collard, N. and Faney, T. and Teboul, P. A. and Bachaud, P. and Cacas-Stentz, M. C. and Gout, C.},
	month = oct,
	year = {2023},
	keywords = {Carbon storage site screening, Dolomitisation, Geochemical modelling, Machine learning, Neural network, Reservoir distribution},
	pages = {121676},
	file = {Accepted Version:C\:\\Users\\Tibo\\Zotero\\storage\\NGBC84MF\\Collard et al. - 2023 - Machine learning model predicting hydrothermal dolomitisation for future coupling of basin modelling.pdf:application/pdf;ScienceDirect Snapshot:C\:\\Users\\Tibo\\Zotero\\storage\\B274WQAX\\S0009254123003765.html:text/html},
}

@article{jonval_parametrization_2025,
	title = {Parametrization and {Cartesian} representation techniques for robust resolution of chemical equilibria},
	volume = {522},
	issn = {0021-9991},
	url = {https://www.sciencedirect.com/science/article/pii/S0021999124008441},
	doi = {10.1016/j.jcp.2024.113596},
	abstract = {Chemical equilibria computations, especially those with vanishing species in the aqueous phase, lead to nonlinear systems that are difficult to solve due to gradient blow up. Instead of the commonly used ad hoc treatments, we propose two reformulations of the single-phase chemical equilibrium problem which are in line with the spirit of preconditioning but whose actual aims are to guarantee a better stability of Newton's method. The first reformulation is a parametrization of the graph linking species mole fractions to their chemical potentials. The second is based on an augmented system where this relationship is relaxed for the iterates by means of a Cartesian representation. We theoretically prove the local quadratic convergence of Newton's method for both reformulations. From a numerical point of view, we demonstrate that the two techniques are accurate, allowing to compute equilibria with chemical species having very low concentrations. Moreover, the robustness of our methods combined with a globalization strategy is superior to that of the literature.},
	urldate = {2025-04-20},
	journal = {Journal of Computational Physics},
	author = {Jonval, Maxime and Ben Gharbia, Ibtihel and Cancès, Clément and Faney, Thibault and Tran, Quang-Huy},
	month = feb,
	year = {2025},
	keywords = {Cartesian representation, Chemical equilibria, Newton's method, Parametrization},
	pages = {113596},
	file = {ScienceDirect Snapshot:C\:\\Users\\Tibo\\Zotero\\storage\\47E7V3EM\\S0021999124008441.html:text/html;Submitted Version:C\:\\Users\\Tibo\\Zotero\\storage\\9WPWG8QZ\\Jonval et al. - 2025 - Parametrization and Cartesian representation techniques for robust resolution of chemical equilibria.pdf:application/pdf},
}

@article{chen_clustering-enhanced_2023,
	title = {Clustering-{Enhanced} {Deep} {Learning} {Method} for {Computation} of {Full} {Detailed} {Thermochemical} {States} via {Solver}-{Based} {Adaptive} {Sampling}},
	volume = {37},
	issn = {0887-0624},
	url = {https://doi.org/10.1021/acs.energyfuels.3c01955},
	doi = {10.1021/acs.energyfuels.3c01955},
	abstract = {Detailed chemistry computations are indispensable in numerous complex simulation tasks, which focus on accurately capturing the ignition process or predicting pollutant levels. The machine learning method is a modern data-driven approach for predicting a full detailed thermochemical state-to-state behavior in reacting flow simulations. By combining unsupervised clustering algorithms to subdivide the composition space, the complexity of adaptive regression models for temporal dynamics can be significantly reduced. In this article, a more compact dataset is generated, which is essential for the clustering algorithm, by leveraging the adaptive CVODE solver time steps for data augmentation for stiff reactive states. A learning workflow that utilizes a deep residual network model (ResNet) in conjunction with an adaptive clustering algorithm is proposed. This approach aims to replace the stiff ordinary differential equation direct integration solver traditionally used for computing thermochemical species’ state-to-state temporal evolution for detailed chemistry simulations. The learning models are adaptively trained using the K-means clustering algorithm in the non-linear transformation space for different subspaces of dynamic systems. Three test cases, H2 (9 species), C2H4 (32 species), and CH4 (53 species), are investigated, each exhibiting varying complexities. The study demonstrates that the iterative predictions of thermochemical states align well with the results obtained from direct numerical integration. Additionally, employing multiple adaptive regression models in subdomains yields superior performance compared to a single regression model prediction case.},
	number = {18},
	urldate = {2025-04-20},
	journal = {Energy \& Fuels},
	author = {Chen, Xi and Mehl, Cédric and Faney, Thibault and Di Meglio, Florent},
	month = sep,
	year = {2023},
	note = {Publisher: American Chemical Society},
	pages = {14222--14239},
	file = {Submitted Version:C\:\\Users\\Tibo\\Zotero\\storage\\3ZHRKW9K\\Chen et al. - 2023 - Clustering-Enhanced Deep Learning Method for Computation of Full Detailed Thermochemical States via.pdf:application/pdf},
}

@article{qu_nneos_2024,
	title = {{NNEoS} : {Neural} network-based thermodynamically consistent equation of state for fast and accurate flash calculations},
	volume = {374},
	issn = {0306-2619},
	shorttitle = {{NNEoS}},
	url = {https://www.sciencedirect.com/science/article/pii/S0306261924014089},
	doi = {10.1016/j.apenergy.2024.124025},
	abstract = {Equations of state (EOS) correlate thermodynamic properties and are essential for flash calculations. However, solving for an EOS can be time-consuming, and EOS do not precisely represent physical reality, causing the deviation of flash results from phase equilibrium data. In this work, we propose a neural network-based EOS (NNEoS) inherently satisfying thermodynamic consistency. NNEoS first predicts the residual Gibbs energy and then derives other thermodynamic properties through differentiation. NNEoS can be trained using an analytical EOS and then serve as a reliable, computationally efficient substitute. NNEoS can also be fine-tuned with experimental data to better match flash results to experimental data. We evaluate the performance of NNEoS against analytical EOS on three case studies, including binary and multicomponent mixtures with and without cross-association. The results show that NNEoS achieves significantly faster flash calculations via GPU-based parallel computing and offers superior predictive accuracy after fine-tuning compared to analytical EOS.},
	urldate = {2025-04-20},
	journal = {Applied Energy},
	author = {Qu, Jingang and Yousef, Soleiman and Faney, Thibault and de Hemptinne, Jean-Charles and Gallinari, Patrick},
	month = nov,
	year = {2024},
	keywords = {Deep learning, Equation of states, Flash calculations, Neural networks, Parallel computing, Two-phase equilibrium},
	pages = {124025},
	file = {ScienceDirect Snapshot:C\:\\Users\\Tibo\\Zotero\\storage\\ZEIPKZB6\\S0306261924014089.html:text/html},
}

@article{nakano_machine_2025,
	title = {Machine {Learning} {Model} for {Gas}–{Liquid} {Interface} {Reconstruction} in {CFD} {Numerical} {Simulations}},
	volume = {10},
	copyright = {http://creativecommons.org/licenses/by/3.0/},
	issn = {2311-5521},
	url = {https://www.mdpi.com/2311-5521/10/1/20},
	doi = {10.3390/fluids10010020},
	abstract = {The volume of fluid (VoF) method is widely used in multiphase flow simulations to track and locate the interface between two immiscible fluids. The relative volume fraction in each cell is used to recover the interface properties (i.e., normal, location, and curvature). Accurate computation of the local interface curvature is essential for evaluation of the surface tension force at the interface. However, this interface reconstruction step is a major bottleneck of the VoF method due to its high computational cost and low accuracy on unstructured grids. Recent attempts to apply data-driven approaches to this problem have outperformed conventional methods in many test cases. However, these machine learning-based methods are restricted to computations on structured grids. In this work, we propose a machine learning-enhanced VoF method based on graph neural networks (GNNs) to accelerate interface reconstruction on general unstructured meshes. We first develop a methodology for generating a synthetic dataset based on paraboloid surfaces discretized on unstructured meshes to obtain a dataset akin to the configurations encountered in industrial settings. We then train an optimized GNN architecture on this dataset. Our approach is validated using analytical solutions and comparisons with conventional methods in the OpenFOAM framework on a canonical test. We present promising results for the efficiency of GNN-based approaches for interface reconstruction in multiphase flow simulations in the industrial context.},
	language = {en},
	number = {1},
	urldate = {2025-04-20},
	journal = {Fluids},
	author = {Nakano, Tamon and Bucci, Michele Alessandro and Gratien, Jean-Marc and Faney, Thibault},
	month = jan,
	year = {2025},
	note = {Number: 1
Publisher: Multidisciplinary Digital Publishing Institute},
	keywords = {graph neural network, interface reconstruction, unstructured mesh, VoF method},
	pages = {20},
	file = {Full Text PDF:C\:\\Users\\Tibo\\Zotero\\storage\\GRM25BLT\\Nakano et al. - 2025 - Machine Learning Model for Gas–Liquid Interface Reconstruction in CFD Numerical Simulations.pdf:application/pdf},
}
